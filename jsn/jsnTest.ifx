{"type":"story_file","value":{"$STORY_LINES":[{"type":"story_statement","value":{"type":"test_statement","value":{"$TEST":{"type":"testing","value":{"id":"3! should equal 6","type":"test_output","value":{"$LINES":{"type":"lines","value":"6"}}}},"$TEST_NAME":{"type":"test_name","value":"factorial"}}}},{"type":"story_statement","value":{"type":"test_rule","value":{"$DOES":[{"type":"execute","value":{"type":"say_text","value":{"$TEXT":{"type":"text_eval","value":{"type":"print_num","value":{"$NUM":{"type":"number_eval","value":{"type":"call_pattern","value":{"$ARGUMENTS":[{"type":"arg","value":{"$FROM":{"type":"assignment","value":{"id":"start the factorial with '3'","type":"from_num","value":{"$VAL":{"type":"number_eval","value":{"type":"num_value","value":{"$VALUE":{"type":"number","value":3}}}}}}},"$NAME":{"type":"text","value":"num"}}}],"$PATTERN":{"type":"pattern_name","value":"factorial"}}}}}}}}}}],"$TEST_NAME":{"type":"test_name","value":"factorial"}}}},{"type":"story_statement","value":{"type":"pattern_decl","value":{"$NAME":{"type":"pattern_name","value":"factorial"},"$PARAMS":[{"type":"field","value":{"id":"just one argument, a number called 'num'","type":"number_field","value":{"$NAME":{"type":"text","value":"num"}}}}],"$PATTERN_RETURN":{"type":"pattern_return","value":{"$RESULT":{"type":"field","value":{"id":"the result uses the same variable as the pattern input does","type":"number_field","value":{"$NAME":{"type":"text","value":"num"}}}}}}}}},{"type":"story_statement","value":{"type":"pattern_actions","value":{"$NAME":{"type":"pattern_name","value":"factorial"},"$RULES":[{"type":"pattern_rule","value":{"$DOES":[{"type":"execute","value":{"type":"assign","value":{"$FROM":{"type":"assignment","value":{"type":"from_num","value":{"$VAL":{"type":"number_eval","value":{"type":"product_of","value":{"$A":{"type":"number_eval","value":{"type":"get_var","value":{"$NAME":{"type":"variable_name","value":"num"}}}},"$B":{"type":"number_eval","value":{"type":"diff_of","value":{"$A":{"type":"number_eval","value":{"type":"get_var","value":{"$NAME":{"type":"variable_name","value":"num"}}}},"$B":{"type":"number_eval","value":{"type":"num_value","value":{"$VALUE":{"type":"number","value":1}}}}}}}}}}}}},"$VAR":{"type":"variable_name","value":"num"}}}}],"$GUARD":{"type":"bool_eval","value":{"type":"always","value":{}}}}}]}}},{"type":"story_statement","value":{"type":"pattern_actions","value":{"$NAME":{"type":"pattern_name","value":"factorial"},"$RULES":[{"id":"the rule considered first is the rule that was written last:","type":"pattern_rule","value":{"$DOES":[{"type":"execute","value":{"type":"assign","value":{"$FROM":{"type":"assignment","value":{"id":"...return 1.","type":"from_num","value":{"$VAL":{"type":"number_eval","value":{"type":"num_value","value":{"$VALUE":{"type":"number","value":1}}}}}}},"$VAR":{"type":"variable_name","value":"num"}}}}],"$GUARD":{"type":"bool_eval","value":{"id":"so, when we've reached 0...","type":"compare_num","value":{"$A":{"type":"number_eval","value":{"type":"get_var","value":{"$NAME":{"type":"variable_name","value":"num"}}}},"$B":{"type":"number_eval","value":{"type":"num_value","value":{"$VALUE":{"type":"number","value":0}}}},"$IS":{"type":"comparison","value":"$EQUAL_TO"}}}}}}]}}}]}}