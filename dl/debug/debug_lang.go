// Code generated by "makeops"; edit at your own risk.
package debug

import (
	"encoding/json"
	"git.sr.ht/~ionous/iffy/dl/composer"
	"git.sr.ht/~ionous/iffy/dl/value"
	"git.sr.ht/~ionous/iffy/export/jsonexp"
	"git.sr.ht/~ionous/iffy/rt"
)

// DebugLog Debug log
type DebugLog struct {
	Value    rt.Assignment `if:"label=_"`
	LogLevel LoggingLevel  `if:"label=as,optional"`
}

func (*DebugLog) Compose() composer.Spec {
	return composer.Spec{
		Name: Type_DebugLog,
		Uses: "flow",
		Lede: "log",
	}
}

var Type_DebugLog = "debug_log"

func (op *DebugLog) MarshalJSON() (ret []byte, err error) {
	if jsonValue, e := op.MarshalJSONValue(); e != nil {
		err = e
	} else if jsonLogLevel, e := op.MarshalJSONLogLevel(); e != nil {
		err = e
	} else {
		ret, err = json.Marshal(jsonexp.Flow{
			Type: Type_DebugLog,
			Value: map[string]json.RawMessage{
				"$VALUE":     jsonValue,
				"$LOG_LEVEL": jsonLogLevel,
			},
		})
	}
	return
}

func (op *DebugLog) MarshalJSONValue() (ret []byte, err error) {
	if v, e := op.Value.(json.Marshaler).MarshalJSON(); e != nil {
		err = e
	} else {
		ret, err = json.Marshal(jsonexp.Slot{
			Type:  rt.Type_Assignment,
			Value: v,
		})
	}
	return
}

func (op *DebugLog) MarshalJSONLogLevel() (ret []byte, err error) {
	ret, err = op.LogLevel.MarshalJSON()
	return
}

// DoNothing Statement which does nothing.
type DoNothing struct {
	Reason string `if:"label=why,optional,type=text"`
}

func (*DoNothing) Compose() composer.Spec {
	return composer.Spec{
		Name: Type_DoNothing,
		Uses: "flow",
	}
}

var Type_DoNothing = "do_nothing"

func (op *DoNothing) MarshalJSON() (ret []byte, err error) {
	if jsonReason, e := op.MarshalJSONReason(); e != nil {
		err = e
	} else {
		ret, err = json.Marshal(jsonexp.Flow{
			Type: Type_DoNothing,
			Value: map[string]json.RawMessage{
				"$REASON": jsonReason,
			},
		})
	}
	return
}

func (op *DoNothing) MarshalJSONReason() (ret []byte, err error) {
	// type override
	m := value.Text{op.Reason}
	ret, err = m.MarshalJSON()
	return
}

// LoggingLevel requires a user-specified string.
type LoggingLevel struct {
	Str string
}

func (op *LoggingLevel) String() (ret string) {
	return op.Str
}

func (*LoggingLevel) Compose() composer.Spec {
	return composer.Spec{
		Name: Type_LoggingLevel,
		Uses: "str",
		Choices: []string{
			LoggingLevel_Note, LoggingLevel_ToDo, LoggingLevel_Fix, LoggingLevel_Info, LoggingLevel_Warning, LoggingLevel_Error,
		},
		Strings: []string{
			"note", "to_do", "fix", "info", "warning", "error",
		},
	}
}

var Type_LoggingLevel = "logging_level"

func (op *LoggingLevel) MarshalJSON() ([]byte, error) {
	return json.Marshal(jsonexp.String{
		Type:  Type_LoggingLevel,
		Value: op.Str,
	})
}

func (op *LoggingLevel) UnmarshalJSON(b []byte) (err error) {
	var d jsonexp.String
	if e := json.Unmarshal(b, &d); e != nil {
		err = e
	} else {
		op.Str = d.Value
	}
	return
}

const LoggingLevel_Note = "$NOTE"
const LoggingLevel_ToDo = "$TO_DO"
const LoggingLevel_Fix = "$FIX"
const LoggingLevel_Info = "$INFO"
const LoggingLevel_Warning = "$WARNING"
const LoggingLevel_Error = "$ERROR"

var Slats = []composer.Composer{
	(*DebugLog)(nil),
	(*DoNothing)(nil),
	(*LoggingLevel)(nil),
}
